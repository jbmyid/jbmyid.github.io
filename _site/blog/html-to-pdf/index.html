<!DOCTYPE html>
<html>
	<head>
	
	<link href="//gmpg.org/xfn/11" rel="profile">
	<meta http-equiv="content-type" content="text/html; charset=utf-8">
	<link rel="canonical" href="http://www.jbmyid.in/blog/html-to-pdf" />
	<meta name="description" content="In most of the projects we get requirements in which we need to send an attachment or download PDFs for order’s e-ticket or any certificate kind of things. So here I have written a post  for how to create PDFs from html using “pdfkit” gem." />
	<meta property="og:description" content="In most of the projects we get requirements in which we need to send an attachment or download PDFs for order’s e-ticket or any certificate kind of things. So here I have written a post  for how to create PDFs from html using “pdfkit” gem." />
	<meta itemprop="image" content="http://www.jbmyid.in/media/2014-02-27-hello-cosette/cover.jpg" />
	<meta property="og:image" content="http://www.jbmyid.in/media/2014-02-27-hello-cosette/cover.jpg" />
	<meta property="og:title" content="Generate PDF(e-ticket) from html in Rails" />
	<meta property="og:type" content="article" />
	<meta property="og:url" content="http://www.jbmyid.in/blog/html-to-pdf" />
	<meta property="og:site_name" content="jbmyid" />
	<title>Generate PDF(e-ticket) from html in Rails &middot; jbmyid</title>
	<meta name="mobile-web-app-capable" content="yes">
	<meta name="HandheldFriendly" content="True" />
	<meta name="MobileOptimized" content="320" />
	<meta name="viewport" content="width=device-width, initial-scale=1.0" />
	<link rel="stylesheet" type="text/css" media="only screen and (min-width: 900px)" href="/assets/css/desktop.css" />
	<link rel="stylesheet" type="text/css" media="only screen and (max-width: 899px)" href="/assets/css/mobile.css" />
	<link href="/assets/css/genericons.css" type="text/css" rel="stylesheet" />
	<link href="/assets/css/syntax.css" type="text/css" rel="stylesheet" />
	<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Fenix:400,400italic">
	<link rel="apple-touch-icon" href="http://www.jbmyid.in/assets/images/icon.png">
	<link rel="shortcut icon" href="http://www.jbmyid.in/assets/images/favicon.ico">
	<link rel="alternate" type="application/rss+xml" title="RSS" href="http://www.jbmyid.in/atom.xml">
	<script type="text/javascript" src="/assets/js/jquery-2.1.0.min.js"></script>
	<script type="text/javascript" src="/assets/js/jquery.stellar.min.js"></script>
</head>

	<body>
		<header class="clean" style="background-image: url(/media/2014-02-27-hello-cosette/cover.jpg); height: 100%;" data-stellar-background-ratio="0.5" data-stellar-horizontal-offset="50">
	
	
	<label class="menu" for="_1">
	<span class="genericon genericon-menu"></span>
</label>
<input id="_1" type="checkbox">
<div class="menu-content">
	<p class="menu-title">jbmyid<p>
	<div class="menu" style="background-color: #1a1a1a; z-index: -1;"></div>
	
		<a href="/">Home</a>
	
		<a href="/about">About</a>
	
	<hr>
	
		<a href="https://twitter.com/jbmyid" class="social-links-menu" target="_blank" title="Follow me on twitter"><span class="genericon genericon-twitter"></span></a>
	
		<a href="https://github.com/jbmyid" class="social-links-menu" target="_blank" title="Fork me on github"><span class="genericon genericon-github"></span></a>
	
		<a href="https://google.com/+jbmyid" class="social-links-menu" target="_blank" title="Add me on google+"><span class="genericon genericon-googleplus-alt"></span></a>
	
		<a href="http://www.jbmyid.com/atom.xml" class="social-links-menu" target="_blank" title="Subscribe to my feed"><span class="genericon genericon-feed"></span></a>
	
</div>
<div class="social-links" data-stellar-ratio="0.1">
	
		<a href="https://twitter.com/jbmyid" target="_blank" title="Follow me on twitter"><span class="genericon genericon-twitter"></span></a>
	
		<a href="https://github.com/jbmyid" target="_blank" title="Fork me on github"><span class="genericon genericon-github"></span></a>
	
		<a href="https://google.com/+jbmyid" target="_blank" title="Add me on google+"><span class="genericon genericon-googleplus-alt"></span></a>
	
		<a href="http://www.jbmyid.com/atom.xml" target="_blank" title="Subscribe to my feed"><span class="genericon genericon-feed"></span></a>
	
</div>

	<div id="post-info" data-stellar-ratio="0.7">
		<h1>Generate PDF(e-ticket) from html in Rails</h1>
		
			<h2>In most of the projects we get requirements in which we need to send an attachment or download PDFs for order’s e-ticket or any certificate kind of things. So here I have written a post  for how to create PDFs from html using “pdfkit” gem.</h2>
		
		<a class="site-title" href="http://www.jbmyid.in"><div class="site-icon-small" style="background-image: url(/assets/images/icon.png);"></div>jbmyid</a>, in 04 April 2014
	</div>
	<div id="nav-icon" style="bottom: 30px;" data-stellar-ratio="4">
		<a class="scroll" data-speed="500" href="#article"><span class="genericon genericon-expand"></span></a>
	</div>
</header>
<div id="middle">
	<div id="article">
		<h1 id="pdfe-ticket-from-html-in-rails">PDF(e-ticket) from html in Rails</h1>

<p>Following are the steps for creating pdf from html views.</p>

<ul>
  <li>Add gem “pdfkit” in gemfile</li>
  <li>Download following 2 files
    <ul>
      <li>wkhtmltopdf-amd64 from <a href="http://code.google.com/p/wkhtmltopdf/downloads/detail?name=wkhtmltopdf-0.9.9-static-amd64.tar.bz2&amp;can=2&amp;q=">here</a></li>
      <li>wkhtmltopdf-i386 from <a href="http://code.google.com/p/wkhtmltopdf/downloads/detail?name=wkhtmltopdf-0.9.9-static-i386.tar.bz2&amp;can=2&amp;q=">here</a></li>
    </ul>
  </li>
  <li>Create “bin” folder in your rails application folder and extract above files in this “bin” folder. These are the binaries which are needed for creating  pdf from html views.</li>
  <li>Create “pdfkit.rb” in “config/initializers” folder of the application. And add following code</li>
</ul>
<pre>
<code class="ruby">
  #pdfkit.rb
  PDFKit.configure do |config|
    if ["development"].include?(Rails.env)
      #only if your are working on 32bit machine
      config.wkhtmltopdf = Rails.root.join('bin', 'wkhtmltopdf-i386').to_s
    else
      #if your site is hosted on heroku or any other hosting server which is 64bit
      config.wkhtmltopdf = Rails.root.join('bin', 'wkhtmltopdf-amd64').to_s
    end
    config.default_options = {
      :encoding=&gt;"UTF-8",
      :page_size=&gt;"A4",
      :margin_top=&gt;"0.25in",
      :margin_right=&gt;"0.1in",
      :margin_bottom=&gt;"0.25in",
      :margin_left=&gt;"0.1in",
      :disable_smart_shrinking=&gt; false
    }
  end
  </code>
</pre>
<ul>
  <li>Create a file e_ticket.rb in models folder as following</li>
</ul>
<pre>
  <code class="ruby">
    # e-ticket
    class ETicket &lt; AbstractController::Base
      include AbstractController::Rendering
      include AbstractController::Helpers
      include AbstractController::Translation
      include AbstractController::AssetPaths
      include Rails.application.routes.url_helpers
      helper ApplicationHelper
      self.view_paths = "app/views"
      attr_reader :html
      def initialize(order)
        @order = order
        @html = render_to_string(partial: "shared/e_ticket", :layout =&gt; false,
             :disposition =&gt; 'inline')
      end
      def pdf
        kit = PDFKit.new(@html)
        kit.stylesheets &lt;&lt; "#{Rails.root}/app/assets/stylesheets/pdf.css"
        kit.to_pdf
      end
    end
  </code>
</pre>

<p>In above code, we have added style sheet “pdf.css” in which we have to write the pdf related css rules. Keep this file as separate for pdf only .
Now you have your e-ticket ready to download and attach to any mail. You have to just create e-ticket by</p>
<pre>
  <code class="ruby">
    eticket = ETicket.new(order)
    pdf = eticket.pdf
  </code>
</pre>

<p>Yehhhhhh……………..its ready to download and attach.</p>

<p>Now I am writing brief for downloading and attaching the pdf to mail.</p>

<h3 id="how-to-download-eticket-pdf">How to download eticket pdf.</h3>
<p>In your orders controller you can create an separate action for downloading or you can do this in your orders show action in pdf response. Any way I am creating separate action for downloading order’s e-ticket pdf.</p>
<pre>
  <code class="ruby">
    class OrdersController &lt; ApplicationController
      def download
        @order = Order.find(params[:id])
        eticket = ETicket.new(@order)
        send_data(eticket.pdf, :filename =&gt; "e-Ticket #{@order.number}",
           :type =&gt; 'application/pdf')
      end
    end
  </code>
</pre>

<h3 id="sending-e-ticket-as-attachment-in-mail">Sending e-ticket as attachment in mail</h3>
<pre>
  <code class="ruby">
    class OrderMailer &lt; ActionMailer::Base
      def send_e_ticket(order)
        @order = order
        subject = " E-Ticket"
        eticket = ETicket.new(@order)
        attachments["E-Ticket #{@order.number}.pdf"] = eticket.pdf
        mail(:to =&gt;”abc@gmail.com”, :subject =&gt;”E-ticket”)
      end
    end
  </code>
</pre>
<p>Now send an mail using following code</p>
<pre>
  <code class="ruby">
    OrderMailer.send_e_ticket(order).deliver
  </code>
</pre>

<p>yippeeeeee…..Mail sent with attached e-ticket pdf.</p>

<h1 id="thank-you">THANK YOU</h1>

	</div>
	
	<div id="comments">
		
	
	<script src="https://apis.google.com/js/plusone.js"></script>
	<div id="g-comments" class="g-comments" data-href="http://www.jbmyid.in/blog/html-to-pdf" data-width="700" data-first_party_property="BLOGGER" data-view_type="FILTERED_POSTMOD"></div>
	<script>
		var width = $('#comments').width() * 0.9;
		width = Math.round(width);
		$("#g-comments").attr({ "data-width": width });
	</script>


	</div>
	
</div>

	
	
	
	
	
	

<footer class="clean" style="background-image: url(/assets/images/cover.jpg); height: 75%; min-height: 500px;" data-stellar-background-ratio="0.5" data-stellar-horizontal-offset="50" data-stellar-vertical-offset="50">
	<div id="nav-icon" style="top: 60px;" data-stellar-ratio="0.8">
		<a class="scroll" data-speed="500" href="#article"><span class="genericon genericon-collapse"></span></a>
	</div>
	<div id="post-info" data-stellar-ratio="0.5" data-stellar-vertical-offset="120">
		<h3>Read next</h3>
		<a href="/blog/rails-4-capistrano">
			<h1>Quick Rails Deployment with Capistrano</h1>
			
				<h2>Deployment of Rails 4 app with Capistrano 3</h2>
			
		</a>
	</div>
	<p class="copyright">&copy;2014, <a href="http://camporez.com" target="_blank">Camporez</a>. <a href="http://creativecommons.org/licenses/by-nc/2.5" target="_blank">Some rights reserved</a>.</p>
</footer>
<script src="/assets/js/smooth-scroll.js"></script>

		<script>
		var width = $(window).width()
		if ( width > 899 )
		$( function(){
		    $.stellar({
		    	responsive: true,
			verticalScrolling: true,
			horizontalOffset: 0,
			verticalOffset: 0,
			positionProperty: 'transform',
		    });
		});
		</script>
	</body>
</html>
